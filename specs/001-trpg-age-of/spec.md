# 機能仕様書: Age of Hero キャラクターシート管理システム

**機能ブランチ**: `001-trpg-age-of`  
**作成日**: 2025-09-08  
**ステータス**: ドラフト  
**入力**: ユーザー説明: "ヒーローTRPG「Age of Hero」のキャラクターシートを作成する。プロジェクトの背景は、キャラクター作成を楽に、またシートの管理をオンラインで一元化することでいつでもどこでもキャラメイクができ、セッションのときはネットワークに繋がってさえいればシート忘れなどなくTRPGを遊ぶことができるからである"

## 実行フロー (main)
```
1. ユーザー説明を入力から解析
   → 抽出: Age of Hero TRPG用キャラクターシート作成・管理システム
2. 説明から主要概念を抽出
   → アクター: プレイヤー, GM（ゲームマスター）
   → アクション: キャラ作成, シート管理, オンラインアクセス
   → データ: キャラクター情報, ステータス, 装備等
   → 制約: ネットワーク接続前提, Age of Heroルール準拠
3. 不明確な側面について:
   → 解決済み: Age of Heroの具体的なゲームシステム・ステータス項目が提供された
   → [要明確化: ユーザー認証方法・アカウント管理]
   → [要明確化: データ保存期間・削除ポリシー]
4. ユーザーシナリオ & テスト セクションを記入
   → プライマリ: キャラクター作成からセッション使用まで
5. 機能要件を生成
   → 各要件はテスト可能で明確
6. 主要エンティティを特定
   → Character, Player, Session等
7. レビューチェックリストを実行
   → 警告 "仕様に不確実性あり - いくつかの明確化が必要"
8. 戻り値: 成功 (明確化後に計画段階へ準備完了)
```

---

## ⚡ クイックガイドライン
- ✅ ユーザーが何を必要とし、なぜ必要かに焦点を当てる
- ❌ 実装方法を避ける（技術スタック、API、コード構造なし）
- 👥 開発者ではなく、ビジネス関係者向けに記述

---

## ユーザーシナリオ & テスト *(必須)*

### 主要ユーザーストーリー
プレイヤーは自宅でAge of Heroのキャラクターを作成し、作成したキャラクター情報をオンラインで保存する。セッション当日、プレイヤーはゲーム会場でスマートフォンやタブレットからキャラクターシートにアクセスし、ステータス更新やダイスロール結果の反映を行いながらゲームを進行する。

### 受け入れシナリオ
1. **前提** 新規プレイヤーがシステムにアクセス, **実行** キャラクター作成を開始, **結果** クラス選択（8種類から2つ選択、重複可能）画面が表示される
1-2. **前提** クラス2つを選択完了, **実行** 能力値算出を実行, **結果** 選択した2つのクラスの能力値を合計（同一クラスの場合2倍）し、任意の能力値に+1ボーナスを適用した結果が表示される
1-3. **前提** 能力値算出完了, **実行** 技能初期値算出とポイント割り振り, **結果** 各技能の初期値（能力値×10％）が表示され、150％分のポイントを任意の技能に割り振り可能（一技能あたり上限100％）
1-4. **前提** 技能割り振り完了, **実行** ヒーロースキル・必殺技・アイテム取得, **結果** ヒーロースキル合計7Lv分、必殺技1Lv、価格20点分のアイテムを選択・取得可能
1-5. **前提** スキル・アイテム取得完了, **実行** HP・SP・行動値算出, **結果** 選択した2クラスのHP・SPを合計し、行動値（反射×2+知力）を算出、ヒーロースキルによる修正を適用した最終ステータスが表示される
2. **前提** 基本能力値設定完了, **実行** ヒーロースキル選択, **結果** 選択したクラスに応じたスキルリストから《パワードライブ》等の特技を選択できる
3. **前提** スキル・装備選択完了, **実行** 保存ボタンを押下, **結果** キャラクター情報（クラス・能力値・スキル・装備）がオンラインに保存され、一意のIDが発行される
4. **前提** セッション中にキャラクターシートにアクセス, **実行** HP・SP・装備の変更を入力, **結果** リアルタイムで変更が保存され、他のデバイスからも同期される
5. **前提** ネットワーク接続が不安定, **実行** データ変更を実行, **結果** 接続回復時に自動的に同期される

### エッジケース
- ネットワーク切断時のデータ保護とローカル保存はどう処理する？
- 同一キャラクターを複数デバイスで同時編集した場合の競合解決は？
- キャラクターデータの誤削除時の復旧機能は必要？

## 要件 *(必須)*

### 機能要件
- **FR-001**: システムはAge of Heroゲームシステムに準拠したキャラクターシート作成機能を提供しなければならない
- **FR-002**: システムはキャラクター情報をオンラインで永続化しなければならない  
- **FR-003**: プレイヤーは作成したキャラクターにいつでもどこでもアクセスできなければならない
- **FR-004**: システムはマルチデバイス対応（PC、スマートフォン、タブレット）でなければならない
- **FR-005**: システムはキャラクター情報の変更を即座に保存しなければならない
- **FR-006**: システムはユーザーを認証し、キャラクターの所有者を識別しなければならない [要明確化: 認証方法 - email/password, SNSログイン, ゲストアクセス等]
- **FR-007**: システムはキャラクターデータを保持しなければならない [要明確化: データ保存期間・削除ポリシー]
- **FR-008**: システムは8つのクラス（マッスル、テクノロジー、マジカル、サイキック、バイオ、エスペラント、アーティファクト、アーツ）から2つを選択可能（重複可能）でなければならない
- **FR-009**: システムは5つの能力値カテゴリー（肉体・反射・感覚・知力・超常）とHP・SP、その下位技能（パワー、技術、射撃、情報等）を管理できなければならない
- **FR-013**: システムは能力値算出機能を提供しなければならない（選択した2つのクラスの能力値を合計、同一クラスの場合2倍、+1ボーナス適用）
- **FR-014**: システムはクラス別の能力値テーブル（マッスル、テクノロジー、マジカル等の各クラスの能力値）を参照できなければならない
- **FR-015**: システムは技能初期値算出機能を提供しなければならない（各技能の初期値＝対応する能力値×10％）
- **FR-016**: システムは技能ポイント割り振り機能を提供しなければならない（合計150％分を任意の技能に割り振り、一技能あたり上限100％）
- **FR-017**: システムは技能値の合計値管理（初期値+割り振りポイント）が100％を超えることを許可しなければならない
- **FR-018**: システムはヒーロースキル取得機能を提供しなければならない（合計7Lv分を任意のヒーロースキルに割り振り）
- **FR-019**: システムは必殺技取得機能を提供しなければならない（1Lvの必殺技を取得）
- **FR-020**: システムは初期アイテム購入機能を提供しなければならない（価格20点分のアイテムを選択・購入）
- **FR-021**: システムはHP・SP算出機能を提供しなければならない（選択した2つのクラスのHP・SPをそれぞれ合計、ヒーロースキルによる修正適用）
- **FR-022**: システムは行動値算出機能を提供しなければならない（行動値＝反射×2+知力、ヒーロースキルによる修正適用）
- **FR-010**: システムはヒーロースキル（《パワードライブ》等）の管理機能を提供しなければならない
- **FR-011**: システムはアイテム管理機能（武器・防具・消耗品・専用アイテム等）を提供しなければならない
- **FR-012**: システムは各スキルの詳細プロパティ（最大Lv、タイミング、効果等）を表示・管理できなければならない

### 主要エンティティ *(機能がデータを含む場合に含める)*
- **Character**: Age of Heroキャラクター情報
  - 基本情報: 名前、クラス（8種類から2つ、重複可能）
  - 能力値: 肉体・反射・感覚・知力・超常の5カテゴリーとHP・SP、その技能値
  - 能力値算出: 選択した2つのクラスの能力値を合計（同一クラスなら2倍）+任意の能力値に+1
  - 技能初期値: 各技能の初期値＝対応する能力値×10％
  - 技能ポイント割り振り: 150％分を任意の技能に割り振り（一技能あたり上限100％、合計値が100％超過可能）
  - ヒーロースキル取得: 合計7Lv分を任意のヒーロースキルに割り振り
  - 必殺技取得: 1Lvの必殺技を取得
  - 初期アイテム: 価格20点分のアイテムを選択・購入
  - HP・SP算出: 選択した2クラスのHP・SPをそれぞれ合計、ヒーロースキルによる修正適用
  - 行動値算出: 行動値＝反射×2+知力、ヒーロースキルによる修正適用
  - ヒーロースキル: 《パワードライブ》等、各スキルのLvと効果
  - 装備・アイテム: 武器・防具・消耗品・専用アイテム
  - ステータス: HP・SP・FC等のリソース管理
  - 行動値: 反射×2+知力で算出、ヒーロースキル修正含む
- **HeroSkill**: ヒーロースキル詳細
  - 基本プロパティ: 名称、最大Lv、タイミング、技能、対象、射程、コスト、効果
- **Item**: アイテム詳細
  - プロパティ: 名称、種別、対応技能、補正、攻撃力、ガード値、射程、価格、効果
- **ClassStats**: クラス別能力値テーブル
  - クラス名: マッスル、テクノロジー、マジカル、サイキック、バイオ、エスペラント、アーティファクト、アーツ
  - 能力値: 肉体、反射、感覚、知力、超常、HP、SPの各値
- **SpecialAttack**: 必殺技詳細
  - プロパティ: 名称、Lv、効果、使用条件等
- **ShopItem**: アイテムショップ情報
  - アイテムリスト: 価格別に結続された購入可能アイテム
  - 価格管理: 20点以内のアイテム選択機能
- **Player**: キャラクターの所有者、認証情報と紐付け
- **Session**: セッション情報、キャラクターの使用履歴

---

## レビュー & 受け入れチェックリスト
*ゲート: main()実行中に自動チェック実行*

### 内容品質
- [x] 実装詳細なし（言語、フレームワーク、API）
- [x] ユーザー価値とビジネスニーズに焦点
- [x] 非技術系関係者向けに記述
- [x] 全ての必須セクション完了

### 要件完全性
- [ ] [要明確化] マーカーが残っていない - **2つの明確化が必要**
- [ ] 要件がテスト可能で曖昧でない  
- [x] 成功基準が測定可能
- [x] スコープが明確に境界設定
- [x] 依存関係と前提条件が特定済み

---

## 実行ステータス
*main()処理中に更新*

- [x] ユーザー説明を解析
- [x] 主要概念を抽出
- [x] 曖昧性をマーク
- [x] ユーザーシナリオを定義
- [x] 要件を生成
- [x] エンティティを特定
- [ ] レビューチェックリスト通過 - **2つの明確化が必要でブロック中**

---